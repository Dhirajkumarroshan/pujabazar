<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDFLboc-AKz1Pw_cNNHVogUyogvQSgwtnY",
    authDomain: "pujabazar-e1ba6.firebaseapp.com",
    projectId: "pujabazar-e1ba6",
    storageBucket: "pujabazar-e1ba6.appspot.com",
    messagingSenderId: "845847820050",
    appId: "1:845847820050:web:4e976f0be28ba15f2ba5cb"
  };

  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  let confirmationResult;

  window.onload = function () {
    window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(
      'recaptcha-container',
      { size: 'invisible' }
    );
    window.recaptchaVerifier.render();
  };

  function sendOTP() {
    const mobile = document.getElementById("mobile").value;
    if (!/^[6-9]\d{9}$/.test(mobile)) {
      alert("Enter valid mobile number");
      return;
    }

    auth.signInWithPhoneNumber("+91" + mobile, window.recaptchaVerifier)
      .then(result => {
        confirmationResult = result;
        alert("OTP Sent");
        document.getElementById("otp").style.display = "block";
        document.getElementById("verifyBtn").style.display = "block";
      })
      .catch(error => alert(error.message));
  }

  function verifyOTP() {
    confirmationResult.confirm(document.getElementById("otp").value)
      .then(() => window.location.href = "index.html")
      .catch(() => alert("Invalid OTP"));
  }
</script>
